<html>
    <head>
        <title>Rich Text Editing Demo</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script>

$(document).ready(function(){
   $('#stuff').html("hi some text to correct");
    document.getElementById('edit').contentWindow.document.designMode = "on";

    if (document.addEventListener) {
        document.getElementById("edit").contentWindow.document.addEventListener("keypress", keypress, true);
    } else if (document.attachEvent) {
        document.getElementById("edit").contentWindow.document.attachEvent("keypress", keypress, true);
    }

    $('#doneButton').click(function(){
        $('#stuff').html($('#edit').contents().find('body').html());
        $('#stuff').show();
        $('#edit').hide();
        $('#doneButton').hide();
        $('#editButton').show();
    });

    $('#editButton').click(function(){
        $('#edit').contents().find('body').html($('#stuff').html());
        $('#stuff').hide();
        $('#edit').show();
        $('#doneButton').show();
        $('#editButton').hide();
        document.getElementById('edit').contentWindow.document.execCommand("forecolor", false, 'red');
        document.getElementById("edit").contentWindow.focus();
    });
});

function keyIs_s_(keycode){
    return keycode == 115 || keycode == 83;
};

function selectionExists(window){
    return window.getSelection() + "" != "";
};

var strikethroughPerformed = false;
function keypress(event){
    // hack for firefox so pressing arrow keys doesn't undo the selection strikethrough
    if (event.which == 0)
        return;

    var win = document.getElementById('edit').contentWindow;

    if(keyIs_s_(event.which) && selectionExists(win)){
        win.document.execCommand("strikethrough", false, null);
        event.preventDefault();
        strikethroughPerformed = true;
    }
    else{
        // hack so typing after a strikethrough doesn't cause text to be in strikethrough
        if (strikethroughPerformed){
            win.document.execCommand("strikethrough", false, null);
            strikethroughPerformed = false;
        }
        win.document.execCommand("forecolor", false, 'red');
    }
};

function start(){

};

    </script>
    </head>
    <body onLoad="start()">
        <div id="stuff"></div>
        <iframe id="edit" width="100%" height="200px" style='display: none'></iframe>
        <button id="doneButton" style='display: none'>Done</button>
        <button id="editButton">Correct</button>
    </body>
</html>
